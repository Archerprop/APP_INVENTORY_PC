<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="static/styles/bootstrap.min.css"
      th:href="@{/styles/bootstrap.min.css}"
      rel="stylesheet"
    />
    <link
      href="static/styles/styles.css"
      th:href="@{/styles/styles.css}"
      rel="stylesheet"
    />
    <script
      src="static/js/sweetalert2.all.min.js"
      th:src="@{/js/sweetalert2.all.min.js}"
    ></script>
    <title>App Inventory PC</title>
  </head>
  <body>
    <header th:insert="fragments/menu :: barra-menu"></header>
    <div class="container w-75 mt-5 rounded shadow">
      <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
          <button
            class="nav-link active"
            id="add-tab"
            data-bs-toggle="tab"
            data-bs-target="#agregar"
            type="button"
            role="tab"
            aria-controls="add"
            aria-selected="true"
          >
            Agregar articulo
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="list-tab"
            data-bs-toggle="tab"
            data-bs-target="#lista"
            type="button"
            role="tab"
            aria-controls="list"
            aria-selected="false"
          >
            Ver articulos agregados
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="report-tab"
            data-bs-toggle="tab"
            data-bs-target="#reporte"
            type="button"
            role="tab"
            aria-controls="report"
            aria-selected="false"
          >
            Reportes
          </button>
        </li>
      </ul>
      <div class="tab-content" id="myTabContent">
        <div
          class="tab-pane fade show active"
          id="agregar"
          role="tabpanel"
          aria-labelledby="add-tab"
        >
          <form th:action="@{/}+${id}" method="post" th:object="${articulo}">
            <div
              class="mb-3"
              th:if="${param.none} OR ${param.success} OR ${param.new}"
            >
              <label for="serial">Serial</label>
              <input
                type="text"
                class="form-control"
                id="serial"
                th:field="*{serial}"
                maxlength="5"
                minlength="5"
                style="text-transform: uppercase"
                placeholder="000AA"
                required
              />
            </div>
            <div
              class="mb-3"
              th:if="${param.none} OR ${param.success} OR ${param.new}"
            >
              <label for="nombre" class="form-label">Nombre</label>
              <input
                type="text"
                class="form-control"
                id="nombre"
                th:field="*{nombre}"
                onclick="return checkSerial();"
                required
              />
            </div>
            <div class="mb-3" th:if="${param.new} OR ${param.old}">
              <label for="stock" class="form-label">Stock</label>
              <input
                type="number"
                class="form-control"
                id="stock"
                th:field="*{stock}"
              />
            </div>
            <div class="mb-3" th:if="${param.new} OR ${param.old}">
              <label for="precioU" class="form-label">Precio Unitario</label>
              <input
                type="number"
                class="form-control"
                id="precioU"
                th:field="*{precioU}"
              />
            </div>
            <div class="d-grid">
              <button
                type="submit"
                class="btn btn-primary"
                onclick="return checkSerial();"
              >
                Agregar
              </button>
            </div>
          </form>
        </div>
        <div
          class="tab-pane fade"
          id="lista"
          role="tabpanel"
          aria-labelledby="list-tab"
        >
          <table class="table table-striped table-bordered m-3">
            <thead class="table-dark">
              <tr>
                <th>Nombre</th>
                <th>Stock</th>
                <th>Precio Unitario</th>
                <th>Precio Bruto</th>
              </tr>
            </thead>
            <tbody>
              <tr th:each="dato : ${articulos}">
                <td th:text="${dato.nombre}">ND</td>
                <td th:text="${dato.stock}">ND</td>
                <td th:text="${dato.precioU}">ND</td>
                <td th:text="${dato.precioB}">ND</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div
          class="tab-pane fade"
          id="reporte"
          role="tabpanel"
          aria-labelledby="report-tab"
        ></div>
      </div>
    </div>

    <script
      src="static/js/bootstrap.bundle.min.js"
      th:src="@{/js/bootstrap.bundle.min.js}"
    ></script>
  </body>
  <script
    src="static/js/jquery-3.6.0.min.js"
    th:src="@{/js/jquery-3.6.0.min.js}"
  ></script>
  <script src="static/js/functions.js" th:src="@{/js/functions.js}"></script>
  <script th:if="${param.success}" th:inline="javascript">
    Swal.fire({
      title: "Articulo agregado",
      text: "El articulo se agrego correctamente",
      icon: "success",
      showConfirmButton: false,
      timer: 2000,
      toast: true,
      position: "top-end",
    }).then(() => {
      var id = /*[[${id}]]*/ "0";
      window.location.href = "/gestor/" + id + "?none";
    });
  </script>
</html>
